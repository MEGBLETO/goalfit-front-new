(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1951],{74316:function(e,t,l){Promise.resolve().then(l.bind(l,44890))},44890:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return b}});var s=l(57437),a=l(84346),n=l.n(a),r=l(2265),i=l(37346),o=l(55211),c=l(65586),d=l(16463),x=l(16356),h=l(63872),m=l(62737),u=l.n(m),g=l(30487),f=l(20357);o.kL.register(o.jn,o.uw,o.f$,o.od,o.Gu,o.u,o.De);var p=l(86688);function b(){let e=(0,d.useRouter)(),[t,l]=(0,r.useState)(null),[a,o]=(0,r.useState)(null),[m,p]=(0,r.useState)(null),[b,j]=(0,r.useState)(null),[v,w]=(0,r.useState)(0),[N,k]=(0,r.useState)(0),[y,M]=(0,r.useState)(0),[C,I]=(0,r.useState)(0),E=e=>{let t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()},S=async()=>{let t=E("token");if(!t){e.push("/login");return}try{let e=n().decode(t);if(!e||!e.userId)throw Error("Invalid token or no userId found");let s=await fetch("".concat("http://localhost:3000","/bdd/user/").concat(e.userId),{method:"GET",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch user data");let a=await s.json();if(l(a),a&&a.mealPlans){let e=a.mealPlans.find(e=>u()(e.day).isToday(u()()));o(e||null),e&&z(e.afternoonMealId)}if(a&&a.workoutPlans){let e=a.workoutPlans.find(e=>u()(e.day).isToday(u()()));e&&F(e.id)}}catch(e){console.error("Error fetching user data:",e)}},z=async e=>{let t=E("token");try{let l=await fetch("http://localhost:5001/bdd/meal/"+e,{method:"GET",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!l.ok)throw Error("Failed to fetch meal plans");let s=await l.json();o(s),s&&T(s.afternoonMeal.name.split(" ").slice(0,3).join(" "));let a=s.morningMeal.nutrition.calories+s.afternoonMeal.nutrition.calories+s.eveningMeal.nutrition.calories;w(a);let n=parseInt(s.morningMeal.nutrition.fat)+parseInt(s.afternoonMeal.nutrition.fat)+parseInt(s.eveningMeal.nutrition.fat);k(n);let r=parseInt(s.morningMeal.nutrition.protein)+parseInt(s.afternoonMeal.nutrition.protein)+parseInt(s.eveningMeal.nutrition.protein);M(r);let i=parseInt(s.morningMeal.nutrition.carbohydrates)+parseInt(s.afternoonMeal.nutrition.carbohydrates)+parseInt(s.eveningMeal.nutrition.carbohydrates);I(i)}catch(e){console.error("Error fetching meal plans:",e)}},T=async e=>{try{let t=await fetch("".concat("https://api.unsplash.com/search/photos","?query=").concat(encodeURIComponent(e),"&client_id=").concat(f.env.UNSPLASH_API_KEY,"&lang=fr")),l=await t.json();if(l.results&&l.results.length>0){let e=l.results[0].urls.regular;j(e)}}catch(e){console.error("Error fetching image:",e)}},F=async e=>{let t=E("token");if(!t){console.error("No token found, please login.");return}try{let l=await fetch("http://localhost:5001/bdd/workout/"+e,{method:"GET",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!l.ok)throw Error("Failed to fetch workout plans");let s=await l.json();p(s.workouts[0])}catch(e){console.error("Error fetching workout plans:",e)}};(0,r.useEffect)(()=>{S()},[]);let P=e=>{var t;if(!(null==e?void 0:null===(t=e.chart)||void 0===t?void 0:t.ctx))return;let l=e.chart.ctx.createLinearGradient(0,230,0,50);return l.addColorStop(1,"rgba(255, 255, 255, 0.8)"),l.addColorStop(.2,"rgba(255, 255, 255, 0.5)"),l.addColorStop(0,"rgba(255, 255, 255, 0)"),l},L=function(e,t,l){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,n=[];for(let r=0;r<l;r++){let l=e+(t-e)/(1+Math.exp(-s*(r-a)));n.push(l)}return n}(95,87,6,1.2,3);return(0,s.jsxs)("div",{className:"min-h-fit",children:[(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"rounded-2xl shadow-md bg-white flex flex-col lg:flex-row items-center justify-between px-10 py-4 my-8 md:py-6 xl:py-8 dark:bg-gray-800",children:[(0,s.jsx)("div",{className:"w-full lg:w-1/3 xl:w-1/4 mb-8 lg:mb-0",children:(0,s.jsx)("h2",{className:"font-manrope text-xl md:text-2xl lg:text-3xl font-bold text-gray-900 mb-4 text-center lg:text-left dark:text-gray-400",children:"Consommation du jour"})}),(0,s.jsx)("div",{className:"w-full lg:w-2/3 xl:w-3/4 lg:ml-20",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"block shrink",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"font-manrope font-bold text-xl md:text-2xl lg:text-3xl text-blue-600 mb-3 text-center lg:text-left",children:[y,(0,s.jsx)("span",{className:"text-sm",children:"g"})]}),(0,s.jsx)("span",{className:"text-gray-900 text-center block lg:text-left dark:text-gray-400 text-sm",children:"Prot\xe9ines"})]}):(0,s.jsx)(g.Z,{variant:"rectangular",width:80,height:40})}),(0,s.jsx)("div",{className:"block shrink",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"font-manrope font-bold text-xl md:text-2xl lg:text-3xl text-blue-600 mb-3 text-center lg:text-left",children:[C,(0,s.jsx)("span",{className:"text-sm",children:"g"})]}),(0,s.jsx)("span",{className:"text-gray-900 text-center block lg:text-left dark:text-gray-400 text-sm",children:"Glucides"})]}):(0,s.jsx)(g.Z,{variant:"rectangular",width:80,height:40})}),(0,s.jsx)("div",{className:"block shrink",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"font-manrope font-bold text-xl md:text-2xl lg:text-3xl text-blue-600 mb-3 text-center lg:text-left",children:[N,(0,s.jsx)("span",{className:"text-sm",children:"g"})]}),(0,s.jsx)("span",{className:"text-gray-900 text-center block lg:text-left dark:text-gray-400 text-sm",children:"Lipides"})]}):(0,s.jsx)(g.Z,{variant:"rectangular",width:80,height:40})}),(0,s.jsx)("div",{className:"block shrink",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"font-manrope font-bold text-xl md:text-2xl lg:text-3xl text-blue-600 mb-3 text-center lg:text-left",children:v}),(0,s.jsx)("span",{className:"text-gray-900 text-center block lg:text-left dark:text-gray-400 text-sm",children:"Total de Calories"})]}):(0,s.jsx)(g.Z,{variant:"rectangular",width:80,height:40})})]})})]})})}),(0,s.jsxs)("div",{className:"grid lg:grid-cols-5 grid-cols-1 gap-4 mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"w-full mt-0 lg:col-span-3 relative",children:[(0,s.jsxs)("div",{className:"relative flex flex-col min-w-0 break-words bg-blue-600 text-white dark:bg-slate-850 border-0 bg-clip-border z-20 rounded-2xl",children:[(0,s.jsxs)("div",{className:"p-6 pt-4 pb-0 border-b-0 rounded-t-2xl mb-0 border-black/12.5",children:[(0,s.jsx)("h5",{className:"font-semibold text-lg",children:"Objectif de poids"}),(0,s.jsxs)("div",{className:"p-4 flex justify-between items-center max-w-md",children:[(0,s.jsx)("div",{className:"text-center",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-lg font-bold",children:[95," ",(0,s.jsx)("span",{className:"text-sm",children:"kg"})]}),(0,s.jsx)("div",{className:"text-sm",children:"Actuel"})]}):(0,s.jsx)(g.Z,{variant:"rectangular",width:80,height:40})}),(0,s.jsx)("div",{className:"text-center",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-lg font-bold",children:[87," ",(0,s.jsx)("span",{className:"text-sm",children:"kg"})]}),(0,s.jsx)("div",{className:"text-sm",children:"Objectif"})]}):(0,s.jsx)(g.Z,{variant:"rectangular",width:80,height:40})})]})]}),(0,s.jsx)("div",{className:"flex-auto p-4",children:t?(0,s.jsx)("div",{children:(0,s.jsx)(i.x1,{options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{grid:{drawBorder:!1,display:!0,borderDash:[5,5]},ticks:{display:!0,color:"#fbfbfb",padding:10,font:{size:10}}},x:{grid:{drawBorder:!1,display:!1,borderDash:[5,5]},ticks:{display:!0,color:"#fbfbfb",padding:20,font:{size:10}}}},plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1}}},data:{labels:["Sep","Oct","Nov","Dec","Jan","Feb"],datasets:[{label:"Poids",data:L,borderColor:"#fbfbfb",backgroundColor:e=>P(e),borderWidth:3,fill:!0,tension:.4,pointRadius:6,pointBackgroundColor:"#1c64f2",pointBorderColor:"#fbfbfb"}]},height:"300"})}):(0,s.jsx)(g.Z,{variant:"rectangular",width:"100%",height:300})})]}),!(null==t?void 0:t.stripeCustomerId)&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-white bg-opacity-20 backdrop-blur-md flex justify-center items-center rounded-2xl z-30",children:(0,s.jsxs)(c.zx,{href:"/subscription",children:[(0,s.jsx)(x.Tmq,{className:"mr-2 h-5 w-5"}),"VIP"]})})]}),(null==a?void 0:a.eveningMeal)&&b?(0,s.jsx)("div",{className:"w-full h-full mt-6 lg:mt-0 min-h-[300px] lg:col-span-2",children:(0,s.jsx)("div",{className:"relative w-full h-full overflow-hidden rounded-2xl",children:(0,s.jsxs)("a",{href:"/mealplan",className:"group relative block h-full",children:[(0,s.jsx)("div",{className:"relative h-full",children:(0,s.jsx)("img",{src:b,alt:"",className:"absolute inset-0 h-full w-full object-cover transition-transform duration-300 ease-in-out transform group-hover:scale-110"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/10"}),(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-start justify-end p-6",children:[(0,s.jsxs)("div",{className:"relative inline-block text-lg font-bold text-transparent",children:[(0,s.jsx)("span",{className:"absolute inset-0 text-black stroke-text",children:a.eveningMeal.name}),(0,s.jsx)("span",{className:"relative text-white",children:a.eveningMeal.name})]}),(0,s.jsxs)("span",{className:"mt-3 bg-blue-600 px-4 py-2 text-xs rounded-lg font-medium uppercase tracking-wide text-white flex items-center",children:[(0,s.jsx)("span",{className:"mr-2",children:"Voir plus"}),(0,s.jsx)("svg",{className:"transition-all duration-500 group-hover:translate-x-1",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M2.25 9L14.25 9M10.5 13.5L14.4697 9.53033C14.7197 9.28033 14.8447 9.15533 14.8447 9C14.8447 8.84467 14.7197 8.71967 14.4697 8.46967L10.5 4.5",stroke:"#fff",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})]})})}):(0,s.jsx)(g.Z,{className:"lg:col-span-2 w-full h-full min-h-[300px] rounded-2xl",variant:"rectangular"})]}),(0,s.jsxs)("div",{className:"grid lg:grid-cols-5 grid-cols-1 gap-4 mx-auto px-4 sm:px-6 lg:px-8 mt-8",children:[m?(0,s.jsx)("div",{className:"col-span-1 lg:col-span-2",children:(0,s.jsxs)("article",{className:"relative isolate flex flex-col justify-end overflow-hidden rounded-2xl px-8 pb-8 pt-40",children:[(0,s.jsx)("img",{src:"https://cdn.dribbble.com/users/2417352/screenshots/16943740/media/2030e4e3a40d20e4330b1300d34e399c.png?resize=1200x900&vertical=centera",alt:"University of Southern California",className:"absolute inset-0 h-full w-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/40"}),(0,s.jsx)("h3",{className:"z-10 mt-3 text-xl font-bold text-white",children:m.name}),(0,s.jsxs)("div",{className:"z-10 gap-y-1 overflow-hidden text-sm leading-6 text-gray-300",children:[(0,s.jsxs)("div",{className:"inline-flex items-center",children:[(0,s.jsx)(x.V3M,{className:"mr-1 h-5 w-5 text-blue-500"}),(0,s.jsx)("p",{className:"text-xs",children:m.duration})]}),(0,s.jsxs)("div",{className:"inline-flex items-center ml-4",children:[(0,s.jsx)(x.EeT,{className:"mr-1 h-5 w-5 text-blue-500"}),(0,s.jsxs)("p",{className:"text-xs",children:["Intensit\xe9: ",m.intensity]})]})]}),(0,s.jsx)("a",{href:"/workoutplan",className:"z-10 absolute bottom-8 right-5 flex cursor-pointer align-middle none center h-12 max-h-[48px] w-12 max-w-[48px] rounded-full bg-blue-600 font-sans text-sm font-bold uppercase text-white shadow-md shadow-blue-500/20 transition-all hover:shadow-lg hover:shadow-blue-500/40 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none","data-ripple-light":"true",children:(0,s.jsx)(h.gmG,{className:"text-2xl mx-auto self-center "})})]})}):(0,s.jsx)(g.Z,{variant:"rectangular",className:"col-span-1 lg:col-span-2 h-full ounded-2xl"}),(0,s.jsx)("div",{className:"col-span-1 lg:col-span-3"})]})]})}u().extend(p)}},function(e){e.O(0,[6051,716,9375,3972,8218,327,2988,7240,7674,251,3355,4779,2882,8213,2971,7023,1744],function(){return e(e.s=74316)}),_N_E=e.O()}]);