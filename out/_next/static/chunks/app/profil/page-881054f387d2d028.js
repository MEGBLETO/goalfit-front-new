(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6099],{17650:function(e,r,t){Promise.resolve().then(t.bind(t,83819))},83819:function(e,r,t){"use strict";t.r(r);var a=t(57437),s=t(2265),l=t(17863);t(64943);var o=t(84346),n=t.n(o),d=t(39343),i=t(7476),c=t(62737),u=t.n(c);let g=e=>{let r="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===r.length)return r.pop().split(";").shift()};r.default=()=>{var e,r;let[t,o]=(0,s.useState)(null),[c,b]=(0,s.useState)(!0),[x,m]=(0,s.useState)(null),[h,f]=(0,s.useState)(!1),[y,p]=(0,s.useState)(!1),{register:k,handleSubmit:j,setValue:v}=(0,d.cI)(),[N,w]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{let e=g("token");if(!e){m("User is not authenticated"),b(!1);return}try{let r=n().decode(e),t=await fetch("".concat("http://localhost:3000","/bdd/user/").concat(r.userId),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch user data");let a=await t.json();a.subscription?"ACTIVE"===a.subscription.status?w("bg-green-100 text-green-800"):w("bg-red-100 text-red-800"):w("bg-gray-100 text-gray-800"),v("name",a.name||""),v("surname",a.surname||""),v("age",a.age||""),v("weight",a.weight||""),v("height",a.height||""),v("contact",a.contact||""),v("email",a.email||""),v("healthConsiderations",a.healthConsiderations||""),v("fitnessLevel",a.fitnessLevel||""),v("dietaryPreferences",a.dietaryPreferences||""),o(a)}catch(e){console.error("Error fetching user data:",e),m(e.message)}finally{b(!1)}})()},[v]);let C=async()=>{if(window.confirm("\xcates-vous s\xfbr de vouloir vous d\xe9sabonner ?"))try{let e=g("token");if(!(await fetch("".concat("http://localhost:3000","/payment/payment/cancel-subscription/").concat(t.subscription.stripeSubscriptionId),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok)throw Error("Failed to update user data")}catch(e){console.error("Error updating user data:",e),m("Failed to update user data")}},E=async e=>{let r={...e,age:Number(e.age),weight:Number(e.weight),height:Number(e.height)};try{let e=g("token"),t=n().decode(e),a=await fetch("".concat("http://localhost:3000","/bdd/user/").concat(t.userId),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("Failed to update user data");let s=await a.json();o(s),f(!0),p(!1),setTimeout(()=>{window.location.reload()},3e3)}catch(e){console.error("Error updating user data:",e),m("Failed to update user data"),setTimeout(()=>{window.location.reload()},3e3)}},P=()=>{p(!0)};return c?(0,a.jsx)("div",{style:{padding:"15px"},children:"Loading..."}):x?(0,a.jsxs)("div",{style:{padding:"15px",color:"red"},children:["Error: ",x]}):(0,a.jsxs)("div",{className:"container mx-auto p-8 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6 text-blue-600 dark:text-blue-400",children:"Profil"}),(0,a.jsxs)("form",{onSubmit:j(E),className:"space-y-8",children:[(0,a.jsxs)(l.mQ,{className:"w-full",children:[(0,a.jsxs)(l.td,{className:"flex border-b border-gray-300 dark:border-gray-700 mb-6",children:[(0,a.jsx)(l.OK,{className:"px-6 py-2 cursor-pointer focus:outline-none transition-all duration-300 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 active:bg-gray-100 dark:active:bg-gray-700",children:"Infos Perso"}),(0,a.jsx)(l.OK,{className:"px-6 py-2 cursor-pointer focus:outline-none transition-all duration-300 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 active:bg-gray-100 dark:active:bg-gray-700",children:"Souscription"}),(0,a.jsx)(l.OK,{className:"px-6 py-2 cursor-pointer focus:outline-none transition-all duration-300 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 active:bg-gray-100 dark:active:bg-gray-700",children:"Repas & Fitness"})]}),(0,a.jsxs)(l.x4,{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3 text-blue-600 dark:text-blue-400",children:"Infos Perso"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nom :"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("name"),onChange:P,defaultValue:null==t?void 0:t.name}),(0,a.jsx)(i.vPQ,{className:"absolute top-2 right-2 text-blue-500 cursor-pointer"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Pr\xe9nom :"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("surname"),onChange:P,defaultValue:null==t?void 0:t.surname}),(0,a.jsx)(i.vPQ,{className:"absolute top-2 right-2 text-blue-500 cursor-pointer"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"\xc2ge :"}),(0,a.jsx)("input",{type:"number",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("age"),onChange:P,defaultValue:null==t?void 0:t.age})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Poids (kg) :"}),(0,a.jsx)("input",{type:"number",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("weight"),onChange:P,defaultValue:null==t?void 0:t.weight})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Taille (cm) :"}),(0,a.jsx)("input",{type:"number",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("height"),onChange:P,defaultValue:null==t?void 0:t.height})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"T\xe9l\xe9phone :"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("contact"),onChange:P,defaultValue:null==t?void 0:t.contact})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"E-mail :"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("email"),defaultValue:null==t?void 0:t.email,readOnly:!0})]})]}),y&&(0,a.jsx)("button",{type:"submit",className:"mt-6 w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-300",children:"Enregistrer"})]}),(0,a.jsx)(l.x4,{children:(0,a.jsxs)("div",{className:"max-w-lg mx-auto p-6 bg-white rounded-lg shadow-lg dark:bg-gray-800",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600 dark:text-blue-400",children:"D\xe9tails de la Souscription"}),(0,a.jsxs)("div",{className:"mb-6 p-4 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("p",{className:"text-lg font-medium text-gray-800 dark:text-gray-300",children:(0,a.jsx)("strong",{children:"Statut :"})}),(0,a.jsx)("div",{className:"inline-flex items-center space-x-2",children:(0,a.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-semibold rounded-full ".concat(N),children:(null==t?void 0:t.subscription)?"ACTIVE"===t.subscription.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 inline-block mr-1 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Actif"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 inline-block mr-1 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Inactif"]}):"Aucun abonnement"})})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("p",{className:"text-lg font-medium text-gray-800 dark:text-gray-300",children:[(0,a.jsx)("strong",{children:"Date de d\xe9but :"})," ",(null==t?void 0:null===(e=t.subscription)||void 0===e?void 0:e.startDate)?u()(t.subscription.startDate).format("YYYY/MM/DD"):"N/A"]})}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("p",{className:"text-lg font-medium text-gray-800 dark:text-gray-300",children:[(0,a.jsx)("strong",{children:"Date de fin :"})," ",(null==t?void 0:null===(r=t.subscription)||void 0===r?void 0:r.endDate)?u()(t.subscription.endDate).format("YYYY/MM/DD"):"N/A"]})}),(0,a.jsx)("div",{className:"mt-6 flex items-center justify-center",children:(0,a.jsx)("button",{type:"button",className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow-lg transition-colors duration-300",onClick:C,children:"Se d\xe9sabonner"})})]})]})}),(0,a.jsxs)(l.x4,{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-3 text-blue-600 dark:text-blue-400",children:"Repas & Fitness"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Etat de sant\xe9 :"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("healthConsiderations"),onChange:P,defaultValue:null==t?void 0:t.healthConsiderations})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Niveau de fitness :"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("fitnessLevel"),onChange:P,defaultValue:null==t?void 0:t.fitnessLevel})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Pr\xe9f\xe9rences alimentaires :"}),(0,a.jsx)("input",{type:"text",className:"w-full px-4 py-2 border rounded-lg bg-gray-50 dark:bg-gray-900 border-gray-300 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-500 focus:ring-1 focus:ring-blue-500",...k("dietaryPreferences"),onChange:P,defaultValue:null==t?void 0:t.dietaryPreferences})]})]}),y&&(0,a.jsx)("button",{type:"submit",className:"mt-6 w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-300",children:"Enregistrer"})]})]}),h&&(0,a.jsx)("p",{className:"mt-4 text-green-500",children:"Les modifications ont \xe9t\xe9 enregistr\xe9es avec succ\xe8s."}),x&&(0,a.jsx)("p",{className:"mt-4 text-red-500",children:x})]})]})}}},function(e){e.O(0,[1690,8218,9956,251,7457,2882,9880,2971,7023,1744],function(){return e(e.s=17650)}),_N_E=e.O()}]);