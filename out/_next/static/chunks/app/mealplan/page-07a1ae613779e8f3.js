(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4466],{43104:function(e,t,a){Promise.resolve().then(a.bind(a,15997))},15997:function(e,t,a){"use strict";a.r(t);var s=a(57437),l=a(2265),r=a(23710),n=a(62737),i=a.n(n);a(10904);var o=a(65586),d=a(16356),c=a(54008),x=a(37692),m=a(66648),u=a(30487),h=a(50965);let p="".concat("http://localhost:3000","/bdd/meal"),f="".concat("http://localhost:3000","/bdd/meal/default");t.default=()=>{let[e,t]=(0,l.useState)(i()().locale("fr")),[a,n]=(0,l.useState)(Z(i()().locale("fr"))),g=(0,l.useRef)(null),[y,j]=(0,l.useState)(0),[v,b]=(0,l.useState)(null),[w,N]=(0,l.useState)({}),[k,S]=(0,l.useState)(!0),[M,E]=(0,l.useState)(!1),[C,I]=(0,l.useState)([]),T=e=>{let t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()},A=async()=>{let e=T("token");if(!e){console.error("No token found, please login.");return}try{let t=await fetch("".concat("http://localhost:3000","/bdd/user"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch user data");let a=(await t.json()).stripeCustomerId?p:f,s=await fetch(a,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch meal plans");let l=await s.json();I(l),S(!1)}catch(e){console.error("Error fetching meal plans:",e),S(!1)}};function Z(e){let t=[];for(let a=-3;a<=3;a++)t.push(e.add(a,"day"));return t}let _=e=>C.some(t=>i()(t.day).isSame(e,"day")),q=async(e,t)=>{try{let a=await fetch("".concat("https://api.unsplash.com/search/photos","?query=").concat(encodeURIComponent(e),"&client_id=").concat("8Rm4rBtXqVlW7LyutI1Y9IsMDC5ovu-OkHqq1NxuCyA","&lang=fr")),s=await a.json();if(s.results&&s.results.length>0){let e=s.results[0].urls.regular;N(a=>({...a,[t]:e}))}}catch(e){console.error("Error fetching image:",e)}};(0,l.useEffect)(()=>{S(!0),A()},[]),(0,l.useEffect)(()=>{let t=C.find(t=>i()(t.day).isSame(e,"day"));b(t||null),N({}),t&&["morningMeal","afternoonMeal","eveningMeal"].forEach(e=>{let a=t[e];a&&q(a.name.split(" ").slice(0,3).join(" "),e)})},[e,C]);let V=e=>{_(e)&&(t(e),n(Z(e)))},z=()=>{if(y<2){var e;let t=y+1;null===(e=g.current)||void 0===e||e.setActiveTab(t),j(t)}else 2===y&&(B(),E(!0))},O=e=>e.format("ddd").replace(/\.$/,""),R=e=>{var t;return(null===(t=v[e])||void 0===t?void 0:t.steps.length)*5||0},B=()=>{(0,h.Z)({particleCount:500,spread:120,origin:{y:.6}})};return(0,s.jsx)("div",{children:k?(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)(u.Z,{variant:"rectangular",width:"100%",height:400}),(0,s.jsx)(u.Z,{variant:"text",width:"60%"}),(0,s.jsx)(u.Z,{variant:"text",width:"80%"}),(0,s.jsx)(u.Z,{variant:"text",width:"40%"})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex justify-center mx-auto pt-4 pb-2 px-2 md:mx-12 mb-6 overflow-hidden",children:a.map((t,a)=>{let l=_(t);return(0,s.jsxs)(r.E.div,{className:"flex group relative mx-1 transition-all duration-300 justify-center w-14 ".concat(t.isSame(e,"day")?"bg-blue-600 shadow-md":l?"hover:bg-blue-500 hover:shadow-md cursor-pointer":"bg-gray-300 cursor-not-allowed"," rounded-full dark:bg-gray-700"),onClick:()=>V(t),"aria-label":"S\xe9lectionner ".concat(t.format("dddd, MMM D")),initial:{opacity:.7,scale:.9},animate:{opacity:t.isSame(e,"day")?1:.7,scale:t.isSame(e,"day")?1:.9},transition:{duration:.3},children:[(0,s.jsx)("div",{className:"flex items-center px-3 py-3",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm ".concat(t.isSame(e,"day")?"text-gray-100 font-semibold":l?"text-gray-900 group-hover:text-gray-100 group-hover:font-semibold dark:text-gray-300":"text-gray-500 dark:text-gray-500"," transition-all duration-300"),children:O(t)}),(0,s.jsx)("p",{className:"mt-2 ".concat(t.isSame(e,"day")?"text-blue-600 font-bold rounded-full bg-white p-1 w-8":l?"text-gray-900 group-hover:text-gray-100 group-hover:font-bold dark:text-gray-300":"text-gray-500 dark:text-gray-500"," transition-all duration-300"),children:t.format("D")})]})}),t.isSame(e,"day")&&(0,s.jsxs)("span",{className:"flex h-1 w-1 absolute bottom-1.5",children:[(0,s.jsx)("span",{className:"animate-ping absolute group-hover:opacity-75 opacity-0 inline-flex h-full w-full rounded-full bg-blue-400"}),(0,s.jsx)("span",{className:"relative inline-flex rounded-full h-1 w-1 bg-blue-100"})]})]},a)})}),(0,s.jsx)("div",{className:"mx-6 sm:mx-6 lg:mx-8",children:v?(0,s.jsx)(o.mQ,{"aria-label":"Meal Plan Tabs",ref:g,activeTab:y,onActiveTabChange:e=>j(e),children:["morningMeal","afternoonMeal","eveningMeal"].map((e,t)=>{var a,l,r,n,i,h,p,f;return(0,s.jsx)(o.mQ.Item,{title:"morningMeal"===e?"Matin":"eveningMeal"===e?"Soir":"Apr\xe8s-midi",icon:"morningMeal"===e?d.hjx:"eveningMeal"===e?x.OqX:x.rvT,children:(0,s.jsxs)("div",{className:"px-6 pt-6 rounded-2xl bg-white pb-6 dark:bg-gray-900",children:[(0,s.jsxs)("div",{className:"relative w-full h-[300px] md:h-[400px]",children:[w[e]?(0,s.jsx)("div",{children:(0,s.jsx)(m.default,{src:w[e],alt:"Image de ".concat(v[e].name),fill:!0,sizes:"100%, 100%",quality:80,priority:!0,className:"rounded-xl mx-auto object-cover"})}):(0,s.jsx)(u.Z,{variant:"rectangular",width:"100%",height:400}),(0,s.jsxs)("div",{className:"absolute shadow rounded-xl opacity-90 w-72 h-16 bg-white dark:bg-gray-800 left-1/2 bottom-4 transform -translate-x-1/2 flex justify-around content-center text-sm text-gray-600 dark:text-gray-400",children:[(0,s.jsxs)("div",{className:"inline-flex items-center",children:[(0,s.jsx)(d.V3M,{className:"mr-1 h-5 w-5 text-gray-600 dark:text-gray-400"}),(0,s.jsxs)("p",{children:[R(e)," min"]})]}),(0,s.jsxs)("div",{className:"inline-flex items-center",children:[(0,s.jsx)(d.EeT,{className:"mr-1 h-5 w-5 text-gray-600 dark:text-gray-400"}),(0,s.jsxs)("p",{children:[null===(a=v[e])||void 0===a?void 0:a.nutrition.calories," ","Kcal"]})]}),(0,s.jsx)("div",{className:"inline-flex items-center",children:(0,s.jsx)(o.zx,{pill:!0,color:"blue",disabled:M,onClick:z,children:2===y?(0,s.jsx)(c.dZ6,{className:"h-6 w-6"}):(0,s.jsx)(c.mR2,{className:"h-6 w-6"})})})]})]}),(0,s.jsx)("h1",{className:"font-manrope font-semibold text-3xl mt-8 text-blue-600 dark:text-blue-300",children:null===(l=v[e])||void 0===l?void 0:l.name}),(0,s.jsxs)("section",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"font-manrope text-2xl text-blue-600 dark:text-blue-300",children:"Ingr\xe9dients"}),(0,s.jsx)(o.aV,{className:"text-gray-800 dark:text-gray-400 mt-2",children:null===(r=v[e])||void 0===r?void 0:r.ingredients.map((e,t)=>(0,s.jsx)(o.aV.Item,{children:e},t))})]}),(0,s.jsxs)("section",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"font-manrope text-2xl text-blue-600 dark:text-blue-300",children:"Instructions"}),(0,s.jsx)(o.aV,{ordered:!0,className:"text-gray-800 dark:text-gray-400 mt-2",children:null===(n=v[e])||void 0===n?void 0:n.steps.map((e,t)=>(0,s.jsx)(o.aV.Item,{children:e},t))})]}),(0,s.jsxs)("section",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"font-manrope text-2xl text-blue-600 dark:text-blue-300",children:"Informations Nutritionnelles"}),(0,s.jsx)("table",{className:"min-w-full",children:(0,s.jsxs)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-400",children:"Calories"}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600 dark:text-blue-300",children:[null===(i=v[e])||void 0===i?void 0:i.nutrition.calories," ","Kcal"]})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-400",children:"Prot\xe9ines"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600 dark:text-blue-300",children:null===(h=v[e])||void 0===h?void 0:h.nutrition.protein})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-400",children:"Glucides"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600 dark:text-blue-300",children:null===(p=v[e])||void 0===p?void 0:p.nutrition.carbohydrates})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-400",children:"Lipides"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600 dark:text-blue-300",children:null===(f=v[e])||void 0===f?void 0:f.nutrition.fat})]})]})})]})]})},t)})}):(0,s.jsx)("p",{children:"Aucun plan de repas disponible pour la date s\xe9lectionn\xe9e."})})]})})}}},function(e){e.O(0,[6051,716,9375,3972,327,2988,8422,3665,3355,8173,4779,7588,2971,7023,1744],function(){return e(e.s=43104)}),_N_E=e.O()}]);